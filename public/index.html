<html>
<head>
<title>NODEJS HOME AUTOMATIONS V1.4</title>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		

<link rel="manifest" href="manifest.json">

	  	<link rel="icon" sizes="192x192" href="../data/img/homescreen/192.png">
	  	<link rel="icon" sizes="128x128" href="../data/img/homescreen/128.png">


<style>

*{ 
margin:0; 
padding:0; 
}
@font-face {
font-family: 'berthold_akzidenz_groteskCn';
src: url('../data/fonts/akzidenzgroteskbe-cn-webfont.eot');
src: url('../data/fonts/akzidenzgroteskbe-cn-webfont.eot?#iefix') format('embedded-opentype'),
url('../data/fonts/akzidenzgroteskbe-cn-webfont.woff') format('woff'),
url('../data/fonts/akzidenzgroteskbe-cn-webfont.ttf') format('truetype'),
url('../data/fonts/akzidenzgroteskbe-cn-webfont.svg#berthold_akzidenz_groteskCn') format('svg');
font-weight: normal;
font-style: normal;
}
html, body, div, span, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
abbr, address, cite, code,
del, dfn, em, img, ins, kbd, q, samp,
small, strong, sub, sup, var,
b, i,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, figcaption, figure,
footer, header, hgroup, menu, nav, section, summary,
time, mark, audio, video {
margin:0;
padding:0;
border:0;
outline:0;
font-size:100%;
vertical-align:baseline;
background:transparent;
}
html,
body {
background:#151515;
color:#c5c5c5;
width:100%;
height:100%;
}
body {
font-family: 'berthold_akzidenz_groteskCn';
font-style: normal;
font-size: 62.5%;
overflow-y: auto;
letter-spacing: 0.08em;
background:transparent;
text-align:left;
}
#container {
margin:0;
padding: 5px 5px 0 5px;
border:0;
outline:0;
width:100%;
height:auto;
display:block;
box-sizing: border-box;
/*max-width:810px;*/
}
#topholder {
width:100%;
display:block;
margin:0;
padding:0;
border:0;
position:relative;
box-sizing: border-box;
}
#holder {
width:100%;
display:block;
background:#151515;
position:relative;
margin:0;
padding:0;
border:0;
box-sizing: border-box;
}
#holdermotion {
width:100%;
display:none;
background:#151515;
position:relative;
margin:0;
padding:0;
border:0;
box-sizing: border-box;
}
img{
margin:0;
padding:0;
border:0;
outline:0;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-o-user-select: none;
user-select: none;
}
.clearall{
clear:both;
}
.noshow {
opacity: 0;
display:none;
}

h1 { 
color: #c5c5c5;
font-size: 1.5em;
line-height: 1.0em;
font-weight: normal;
margin: 0px;
text-transform:uppercase;
}
.prefix{ 
color: #4292f4;
float:left;
margin-right: 10px;
}
.green {
color: #0fd600;
}
.darkgreen {
color: #0a8c01;
}
.orange {
color: #ff7200;
}
.white {
color: #fff;
}
h2 { 
color: #c5c5c5;
font-size: 2.5em;
line-height: 1.0em;
font-weight: normal;
margin: 0px;
text-transform:uppercase;
}

.butt { 
margin: 0px;
width:194px;
height: 100px;
font-size: 2em;
line-height: 100px;
padding:0;
border:0;
cursor: pointer !important;
margin:0px 5px 5px 0px;
display:block;
float:left;
outline:0;
background:#bb1313 url('../data/img/corner.png') no-repeat top right;
text-align:center;
}

.stream { 
margin: 0px;
width:393px;
height: 205px;
padding:0;
border:2px solid #4292f4;
cursor: none !important;
margin:0px 5px 5px 0px;
display:block;
float:left;
outline:0;
background-color:#007f8a;
text-align:center;
box-sizing: border-box;
}

.stream img { 
width:100%;
height: 100%;
padding:0;
border:0;
cursor: none !important;
margin:0;
display:block;
outline:0;
background-color:#007f8a;
text-align:center;
-webkit-touch-callout: none !important;
-webkit-user-select: none !important;
-khtml-user-select: none !important;
-moz-user-select: none !important;
-ms-user-select: none !important;
user-select: none !important;
}

#feedbackholder, #feedbackholderR, #feedbackholderM, #feedbackholderOpenClose {
display:block;
width:100%;
padding:10px;
margin:0 0 5px 0;
border:2px solid #4292f4;
box-sizing: border-box;
font-size: 2em;
line-height: 1.0em;
font-weight: normal;
text-transform:uppercase;
color: #c5c5c5;
background: #222;
}
#gasalarm, #motionOpen, #motionClose {
display:block;
width:100%;
height:30px;
}




@media screen and (max-width: 800px) {

body {
font-family: 'berthold_akzidenz_groteskCn';
font-style: normal;
font-size: 62.5%;
overflow-y: hidden;
overflow-x: hidden;
letter-spacing: 0.08em;
background:transparent;
text-align:left;
cursor: none !important;
   -webkit-touch-callout: none !important;
   -webkit-user-select: none !important;
   -khtml-user-select: none !important;
   -moz-user-select: none !important;
   -ms-user-select: none !important;
   user-select: none !important;
}
#container {
margin:0;
padding: 5px 4px 0 4px;
border:0;
outline:0;
width:800px;
height:auto;
display:block;
cursor: none !important;
box-sizing: border-box;
}
.stream { 
margin: 0px;
width:393px;
height: 205px;
padding:0;
border:0;
cursor: none !important;
margin:0px 0px 5px 5px;
display:block;
float:left;
outline:0;
background-color:#007f8a;
text-align:center;
   -webkit-touch-callout: none !important;
   -webkit-user-select: none !important;
   -khtml-user-select: none !important;
   -moz-user-select: none !important;
   -ms-user-select: none !important;
   user-select: none !important;
}
.stream img { 
margin: 0px;
width:100%;
height: 100%;
padding:0;
border:0;
cursor: none !important;
margin:0;
display:block;
outline:0;
background-color:#007f8a;
text-align:center;
   -webkit-touch-callout: none !important;
   -webkit-user-select: none !important;
   -khtml-user-select: none !important;
   -moz-user-select: none !important;
   -ms-user-select: none !important;
   user-select: none !important;
}

.butt { 
margin: 0px;
width:194px;
height: 100px;
font-size: 2em;
line-height: 100px;
padding:0;
border:0;
cursor: none !important;
margin:0px 5px 5px 0px;
display:block;
float:left;
outline:0;
background:#bb1313 url('../data/img/corner.png') no-repeat top right;
text-align:center;
   -webkit-touch-callout: none !important;
   -webkit-user-select: none !important;
   -khtml-user-select: none !important;
   -moz-user-select: none !important;
   -ms-user-select: none !important;
   user-select: none !important;
    }

.butt:nth-child(4n+4) {
   margin:0px 0px 5px 0px; 
}

#feedbackholder, #feedbackholderR, #feedbackholderM, #feedbackholderOpenClose {
display:block;
width:100%;
padding:10px;
margin:0 0px 5px 0;
border:2px solid #4292f4;
box-sizing: border-box;
font-size: 2em;
line-height: 1.2em;
font-weight: normal;
text-transform:uppercase;
color: #c5c5c5;
background: #222;

}
#gasalarm {
display:block;
width:100%;
height:50px;
}

#feedbackholderM{
	padding:0;
}

}


@media screen and (max-width: 380px) {

*{ 
margin:0; 
padding:0; 
-webkit-user-select: none !important;
cursor: none !important;
}

body {
font-family: 'berthold_akzidenz_groteskCn';
font-style: normal;
font-size: 62.5%;
overflow-y: hidden;
overflow-x: hidden;
letter-spacing: 0.08em;
background:transparent;
text-align:left;
cursor: none;

}
#container {
margin:0;
padding: 10px 10px 0 10px;
border:0;
outline:0;
width:100%;
height:100%;
cursor: none !important;
display: flex;
flex-flow: column;
box-sizing: border-box;
}

#topholder {
width:100%;
display:block;
margin:0;
padding:0;
border:0;
box-sizing: border-box;
}

#holder {
position:relative;
width:100%;
flex: 1 1 auto;
margin:0;
padding:0;
border:0;
box-sizing: border-box;
height:100%;
overflow-x:hidden;
}
#holdermotion {
display:none;
position:relative;
width:100%;
flex: 1 1 auto;
margin:0;
padding:0;
border:0;
box-sizing: border-box;
height:100%;
overflow-x:hidden;
}
img{
margin:0;
padding:0;
border:0;
outline:0;
cursor: none !important;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-o-user-select: none;
user-select: none;
}

.stream { 
margin: 0px;
width:100%;
height: auto;
padding:0;
border:2px solid #4292f4;
cursor: none !important;
margin:0 0 10px 0;
display:block;
outline:0;
background-color:#007f8a;
text-align:center;
box-sizing: border-box;
-webkit-touch-callout: none !important;
-webkit-user-select: none !important;
-khtml-user-select: none !important;
-moz-user-select: none !important;
-ms-user-select: none !important;
user-select: none !important;
}

.stream img { 
margin: 0px;
width:100%;
height: 100%;
padding:0;
border:0;
cursor: none !important;
margin:0;
display:block;
outline:0;
background-color:#007f8a;
text-align:center;
-webkit-touch-callout: none !important;
-webkit-user-select: none !important;
-khtml-user-select: none !important;
-moz-user-select: none !important;
-ms-user-select: none !important;
user-select: none !important;
}

.butt { 
margin: 0px;
width:100%;
height: 70px;
font-size: 3em;
line-height: 70px;
padding:0;
border:0;
cursor: none !important;
margin:0 0 5px 0;
display:block;
outline:0;
background:#bb1313 url('../data/img/cornermob.png') no-repeat top right;
text-align:center;
-webkit-touch-callout: none !important;
-webkit-user-select: none !important;
-khtml-user-select: none !important;
-moz-user-select: none !important;
-ms-user-select: none !important;
user-select: none !important;
}
.butt:nth-child(4n+4) {
   margin:0px 0px 5px 0px; 
}

#feedbackholder, #feedbackholderR, #feedbackholderM, #feedbackholderOpenClose {
display:block;
width:100%;
padding:5px;
margin:0 0 5px 0;
border:2px solid #4292f4;
box-sizing: border-box;
font-size: 1.3em;
line-height: 1.0em;
font-weight: normal;
text-transform:uppercase;
color: #c5c5c5;
background: #222;
height: 52px;
}
#feedbackholderR{
	font-size: 1.2em;
}
#feedbackholderM{
	padding:0;
}

#gasalarm, #motionOpen, #motionClose {
display:block;
width:100%;
height:48px;
}

}

#feedbackholder {
display:block;
width:55%;
float: left;
}
#feedbackholderM {
display:block;
width:10%;
float: right;
border-left:none;
text-align: center;
}
#feedbackholderR {
display:block;
width:25%;
float: right;
border-left:none;
text-align: center;
}
#feedbackholderOpenClose {
display:block;
width:10%;
float: right;
border-left:none;
text-align: center;
}
#feedbackholderR h1{
color: #ff7200;
}

#motionOpen {
background-color: #00b235;
}
.motion {
	background-color: #888;
}

</style>

<script src="socket.io/socket.io.js"></script>

</head>
<body>

<div id="container">

	<div id="topholder">

		<div id="feedbackholder">
			<h1 class="prefix">Last status: </h1>
			<span id="feedback"><h1>No Connection with back-end</h1></span>
		</div>

		<div id="feedbackholderM">
			<span id="gasalarm"></span>
		</div>

		<div id="feedbackholderR">
			<span id="feedbackR"><h1>---</h1></span>
		</div>

		<div id="feedbackholderOpenClose">
			<span id="motionOpen" onclick="openMotion();"> </span>
		</div>

	</div>

	<div id="holder">

		<div class="butt" id="wol4" btype="wol" wake="E8-94-F6-68-4D-D6" onclick="relay(this)"> MAIN ROUTER </div> 
		<div class="butt" id="wol1" btype="wol" wake="6C-F0-49-E6-73-EB" onclick="relay(this)"> WORKSTATION 1</div> 
		<div class="butt" id="wol2" btype="wol" wake="C0-3F-D5-6B-31-F4" onclick="relay(this)"> WORKSTATION 2 </div> 
		<div class="butt" id="wol3" btype="wol" wake="B8-27-EB-28-E2-2E" onclick="relay(this)"> MEDIA PI2 </div>


		<div class="butt" id="local1" btype="local" wake="" onclick="relay(this)"> NODE1 </div> 
		<div class="butt" id="local2" btype="local" wake="" onclick="relay(this)"> NODE2 </div> 
		<div class="butt" id="local3" btype="local" wake="" onclick="relay(this)"> NODE3 </div> 
		<div class="butt" id="local4" btype="local" wake="" onclick="relay(this)"> NODE4 </div>

		<div class="butt" id="switch1" btype="switch" wake="" onclick="relay(this)"> PARKING </div>
		<div class="butt" id="switch2" btype="switch" wake="" onclick="relay(this)"> SERIAL2 </div>
		<div class="butt" id="switch3" btype="switch" wake="" onclick="relay(this)"> SERIAL3 </div>

	</div>

	<div id="holdermotion">

		<div class="butt motion" id="motion1" > Motion Room 1 </div>
		<div class="butt motion" id="motion2" > Motion Room 2 </div>

	</div>

</div>

<script>

// CONNECT
var socket = io.connect();
var Feedback = document.getElementById("feedback");
var TempHumid = document.getElementById("feedbackR");


// OPEN/CLOSE MOTION FLOORMAP
function openMotion(){
    var div = document.getElementById("holder");
		if (div.style.display !== "none") {
			div.style.display = "none";
			document.getElementById('holdermotion').style.display = "block";
		} else {
    		div.style.display = "block";
			document.getElementById('holdermotion').style.display = "none";
		}
 	}


// EMIT ID TO BACKEND
function relay(obj){
		var buttonid = obj.id;
		var buttontype = obj.getAttribute("btype");
		var buttonwake = obj.getAttribute("wake");
		socket.emit('relaycmd', {id: buttonid, type: buttontype, wake: buttonwake});
	}


// SENSORS (SEP SOCKET)
	socket.on('sensorCallback', function (data) {
       	var type = data.type
       	var temp = data.temp
       	var humid = data.humid

		// TEMP/HUMID SENSOR
		TempHumid.innerHTML = "<h1>" + temp + "°C / " + humid + "%</h1>";
	});


// BUTTON ON/OFF STATUSSES
	socket.on('relayCallback', function (data) {

		var id = data.id
       	var active = data.active
       	var type = data.type


    // ON

	       	if (active == 1) {

	       		// WAKE ON LAN BUTTONS
					if (type == 'wol') {
						document.getElementById(type + id).style.backgroundColor = "#0097b2";
						Feedback.innerHTML = "<h1>MACHINE ONLINE</h1>";
				// SERIAL SWITCH BUTTONS
					} else if (type == 'switch') {
						document.getElementById(type + id).style.backgroundColor = "#7c00b2";
						Feedback.innerHTML = "<h1>SERIAL "+id+" ON</h1>";
				// RELAY BUTTONS
					} else if (type == 'local') {
						document.getElementById(type + id).style.backgroundColor = "#00b235";
						Feedback.innerHTML = "<h1>Node "+id+" ON</h1>";
				// GAS SENSORS
					} else if (type == 'gas') {
						document.getElementById('gasalarm').style.backgroundColor = "#bb1313";
						Feedback.innerHTML = "<h1>Gas Detected!</h1>";
				// MOTION SENSORS
					} else if (type == 'motion') {
						document.getElementById(type + id).style.backgroundColor = "#bb1313";
						document.getElementById('motionOpen').style.backgroundColor = "#bb1313";
						Feedback.innerHTML = "<h1>Motion Detected!</h1>";
					} else {
				// ELSE ERROR
						Feedback.innerHTML = "<h1>Node "+id+" ERROR!</h1>";
					}
	// OFF

			} else if (active == 0) {
					
				// WAKE ON LAN BUTTONS
					if (type == 'wol') {
						Feedback.innerHTML = "<h1>MACHINE OFFLINE</h1>";
						document.getElementById(type + id).style.backgroundColor = "#bb1313";
				// SERIAL SWITCH BUTTONS
					} else if (type == 'switch') {
						Feedback.innerHTML = "<h1>SERIAL "+id+" OFF</h1>";
						document.getElementById(type + id).style.backgroundColor = "#bb1313";
				// RELAY BUTTONS
					} else if (type == 'local') {
						Feedback.innerHTML = "<h1>NODE "+id+" OFF</h1>";
						document.getElementById(type + id).style.backgroundColor = "#bb1313";
				// GAS SENSORS
					} else if (type == 'gas') {
						document.getElementById('gasalarm').style.backgroundColor = "#00b235";
				// MOTION SENSORS
					} else if (type == 'motion') {
						document.getElementById(type + id).style.backgroundColor = "#00b235";
						document.getElementById('motionOpen').style.backgroundColor = "#00b235";
				// ELSE ERROR
					} else {
						Feedback.innerHTML = "<h1>NODE "+id+" ERROR!</h1>";
					}


	// TEMP BOOTING WAKEONLAN/SERIAL WAIT STATUS 

			} else if (active == 3) {			
						Feedback.innerHTML = "<h1>MACHINE BOOTING</h1>";
						document.getElementById(type + id).style.backgroundColor = "#e57e00";
			} else if (active == 4) {			
						Feedback.innerHTML = "<h1>SERIAL " + id + " </h1>";
						document.getElementById(type + id).style.backgroundColor = "#e57e00";
			}
	});


    

</script>
</body>
</html>